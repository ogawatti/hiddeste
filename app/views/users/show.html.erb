<%- model_class = User -%>
<div class="page-header">
  <h1><%=t '.title', :default => @user.name %></h1>
</div>

<% event_leave_button_class  = "btn btn-danger" %>

<% unless @user.events.empty? %>
  <table class="table table-striped table-condensed">
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Place</th>
        <th>Date</th>
        <th>Organizer</th>
        <th>Organizer?</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <% @user.events.each do |event| %>
        <td><%= event.id %></td>
        <td><%= link_to event.name, "/events/#{event.id}" %></td>
        <td><%= event.place %> </td>
        <td><%= event.date %> </td>
        <td><%= event.organizer.name %></td>
        <td>
          <% if current_user.id == event.organizer_id %>
            <i class="icon-ok"></i>
          <% end %>
        </td>
        <td>
          <% user_event = UserEvent.where(user_id: current_user.id, event_id: event.id).first %>
          <% action  = { controller: "user/events", action: :destroy, id: user_event.id } %>
          <% options = { :class => event_leave_button_class, method: :delete } %>
          <% if current_user.id == event.organizer_id %>
            <%= button_to "Leave", action, options.merge( disabled: true ) %>
          <% else %>
            <%= button_to "Leave", action, options %>
          <% end %>
        </td>
      </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <%= "nothing" %>
<% end %>

